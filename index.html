<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAssembly + C Basics</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: #1a1a2e;
            color: #eee;
            line-height: 1.6;
        }
        h1 {
            color: #00d4ff;
            border-bottom: 2px solid #00d4ff;
            padding-bottom: 0.5rem;
        }
        h2 {
            color: #ff6b6b;
            margin-top: 2rem;
        }
        .demo-section {
            background: #16213e;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        button {
            background: #00d4ff;
            color: #1a1a2e;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 0.25rem;
            transition: transform 0.1s;
        }
        button:hover {
            transform: scale(1.05);
        }
        button:active {
            transform: scale(0.95);
        }
        input {
            padding: 0.5rem;
            border-radius: 4px;
            border: 1px solid #00d4ff;
            background: #0f0f23;
            color: #eee;
            width: 80px;
            margin: 0.25rem;
        }
        .result {
            font-size: 1.5rem;
            color: #00ff88;
            font-family: monospace;
            margin-top: 1rem;
        }
        #status {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }
        .loading { background: #ff9f1c33; color: #ff9f1c; }
        .ready { background: #00ff8833; color: #00ff88; }
        .error { background: #ff6b6b33; color: #ff6b6b; }
        code {
            background: #0f0f23;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <h1>WebAssembly + C Basics</h1>
    
    <div id="status" class="loading">Loading WebAssembly module...</div>

    <h2>1. Basic Math Operations</h2>
    <div class="demo-section">
        <p>Call C functions from JavaScript:</p>
        <input type="number" id="num1" value="5" />
        <input type="number" id="num2" value="3" />
        <br>
        <button onclick="doAdd()">Add</button>
        <button onclick="doMultiply()">Multiply</button>
        <div class="result" id="math-result">Result: -</div>
    </div>

    <h2>2. Stateful Counter</h2>
    <div class="demo-section">
        <p>Demonstrates that C maintains state between calls:</p>
        <button onclick="doIncrement()">Increment</button>
        <button onclick="doReset()">Reset</button>
        <div class="result" id="counter-result">Counter: 0</div>
    </div>

    <h2>3. How It Works</h2>
    <div class="demo-section">
        <p><strong>C Code</strong> → <code>emcc</code> compiler → <strong>.wasm</strong> binary + <strong>.js</strong> glue code</p>
        <p>The <code>EMSCRIPTEN_KEEPALIVE</code> macro exports functions to JavaScript.</p>
        <p>Functions are accessed via <code>Module._functionName()</code></p>
    </div>

    <script>
        var Module = {
            onRuntimeInitialized: function() {
                document.getElementById('status').className = 'ready';
                document.getElementById('status').textContent = 'WebAssembly module ready!';
                updateCounter();
            }
        };

        function doAdd() {
            const a = parseInt(document.getElementById('num1').value) || 0;
            const b = parseInt(document.getElementById('num2').value) || 0;
            const result = Module._add(a, b);
            document.getElementById('math-result').textContent = `${a} + ${b} = ${result}`;
        }

        function doMultiply() {
            const a = parseInt(document.getElementById('num1').value) || 0;
            const b = parseInt(document.getElementById('num2').value) || 0;
            const result = Module._multiply(a, b);
            document.getElementById('math-result').textContent = `${a} × ${b} = ${result}`;
        }

        function doIncrement() {
            Module._increment();
            updateCounter();
        }

        function doReset() {
            Module._reset_counter();
            updateCounter();
        }

        function updateCounter() {
            const value = Module._get_counter();
            document.getElementById('counter-result').textContent = `Counter: ${value}`;
        }
    </script>
    <script src="build/main.js"></script>
</body>
</html>
